\ifx \globalmark \undefined %% This is default.
	\input{header}
	\begin{document} %% Crashes if put after (one of the many mysteries of LaTeX?).
\else 
	\documentclass{standalone}
	\begin{document}
\fi

\graphicspath{ {Chapitre5/images/} }	

\setcounter{chapter}{4}
\chapter{Reaction systems}
\chaptermark{Reaction systems}\label{sysreac}	
	
\lettrine[lines=1]{\bf T}{}he reaction system concept applies for a dynamic systems class used in various engineering domains such as chemistry, biomedical, biotechnologies or ecology. Under a spatial homogeneity assumption, reaction systems dynamic is described by 
balance differential equations.

These equations are obtained from a combination of a {\em reaction network }
which encodes the reactions that are supposed to occur in the system with two basic physical phenomena: 
the {\em reactions kinetic } from one part and the {\em exchange dynamics } from the other part.
Those various elements describing reaction systems will be presented in the following sections, starting by reaction networks.

\section{Reaction networks}
A reaction system is characterized by a given number of {\em reactions} between chemical or biological components.
The number of components is finite and we denote those components using the following symbols:
\eqnn 
X_1, X_2, X_3,  \ldots , X_n.
\eeqnn 
The number of reactions is also a finite number $m$ and those reactions occur inside a geometrically well defined domain.
For example, a chemical reactor if it occurs between chemical components or an ecological niche between animal species.
The domain boundary is also well defined and split the system from the external world.

The easiest way to introduce the reaction network concept is to start with an example.

\begin{exemple} {\bf Chemical reaction}

The reaction mechanism between nitric oxide and hydrogen is described 
using the following reaction network which has $m=4$ reactions employing $n=6$ chemical components:
\eqn 
2X_1 &\longrightarrow& X_2 \label{oxnit1}\\ 
X_2 &\longrightarrow& 2X_1 \\ 
X_2 + X_3&\longrightarrow& X_4 + X_5 \\ 
X_3 + X_5 &\longrightarrow& 2X_6 \label{oxnit4}  
\eeqn 
The six components are : $X_1 = NO$, $X_2 = N_2O_2$, $X_3 = H_2$, $X_4 = N_2$,
$X_5 = H_2O_2$, $X_6 = H_2O$.   \qed
\end{exemple}

A reaction network is therefore a set of $m$ reactions in the following form:
\eqnn 
\sum_{i=1}^n\gamma_{ij}X_i \longrightarrow
\sum_{i=1}^n\delta_{ij}X_i  \hspace{5mm} j=1,\ldots,m \hspace{5mm}
\gamma_{ij} \geq 0 \hspace{5mm} \delta_{ij} \geq 0.
\eeqnn 
The coefficients $\gamma_{ij}$ and $\delta_{ij}$ are positive real numbers called {\em stoichiometric coefficients}.
They represent the nominal quantity for the component $X_i$ 
which is consumed or produced by the $j^{th}$ reaction.
For example, the fourth network reaction above means: 
one mole of $X_3$ combined to one mole of $X_5$ produces two moles of $X_6$. 

We introduce the following matrix notations :
\begin{equation*} \begin{split}
\Gamma &= [\gamma_{ij}] \hh \hh \mbox{matrix } n \times m \text{ with elements } \gamma_{ij} \\
\Delta &= [\delta_{ij}] \hh \hh \mbox{matrix } n \times m \text{ with elements } \delta_{ij}
\end{split} \end{equation*}
The {\em stoichiometric matrix} is defined as :
\begin{equation*} \begin{split}
C = \Delta - \Gamma.
\end{split} \end{equation*}
The matrix rank $p$ is called the {\em reaction network rank}.
It corresponds to the numbers of independent reactions.

As a convention, all reactions are denoted with an arrow from the left to the right.
In the example above, the {\em reversible} reaction $2X_1 \leftrightarrows X_2$ 
is encoded as two simple distinct reactions : 
\eqnn 
2X_1 &\longrightarrow& X_2 \\ X_2
&\longrightarrow& 2X_1 
\eeqnn

\subsection* {Reactants and products}

The {\em reactants} are the components $X_i$ 
which are written on the left hand side of the arrow with a coefficient $\gamma_{ij} > 0$.

The {\em products} are the components $X_i$ 
which are written on the right hand side of the arrow with a coefficient $\delta_{ij} > 0$. 

A component $X_i$ can either be a reactant in a reaction and a product in another or the same reaction.
This is the case of the component $X_5$ in the example 5.1.

A {\em terminal product} is a component produced by at least one reaction but which is a reactant of none reaction.

An {\em initial reactant} is a component consumed by at least one reaction but which is produced by no reaction.

As an example, in the reaction network (\ref{oxnit1}) - (\ref{oxnit4}),
we identify the following subsets : 

\begin{tabular}{ccc}
Reactants & : & $X_1, X_2, X_3, X_5$ \\
Products  & : & $X_1, X_2, X_4, X_5, X_6$ \\
Initial reactant & : & $X_3$ \\
Terminal products & : & $X_4, X_6$ \\
\end{tabular}

\subsection* {Catalysts et autocatalysts}

As we just explained, a given component can be on both sides of a reaction.
The component $X_2$ is an example in the following reaction :
\eqnn \gamma_1X_1 + \gamma_2X_2 \longrightarrow \delta_2X_2 + \delta_3X_3 \eeqnn 

If $\gamma_2 = \delta_2$ the component $X_2$ is a {\em catalyst}, in other words a component which is neither consumed nor produced but whose presence is required to perform the reaction.

If $\gamma_2 < \delta_2$, the component $X_2$ is an {\em autocatalyst},
a component which is a catalyst in its own production.

We also use an alternative representation for catalytic and autocatalytic reactions.
It consists in not writing the catalyst on the left side of the reaction
but indicating it under the arrow without coefficient 
and balancing it on the right side of the reaction with the coefficient $\delta_2 - \gamma_2$ :
\eqnn \gamma_1X_1  \cata{X_2} (\delta_2 - \gamma_2)X_2 + \delta_3X_3 \eeqnn 

Among the most typical autocatalytic reaction examples we can quote 
polymerization reactions or microbial growth reactions as described in the following example.

\begin{exemple} {\bf \em Alcoholic fermentation}

The alcoholic fermentation underlying mechanism can be described by the following reaction network :

 \eqnn X_1 + 2.33X_2 +
0.525X_3 &\cata{X_4}& 3.5X_4 + 2.5X_5 + 3.66X_6 \nonumber \\ X_1 +
0.054X_3 &\cata{X_4}& 0.36X_4 + 1.89X_5 + 0.14X_6 + 1.88X_7 \nonumber \\
1.61X_2 + 0.193X_3 + X_7 &\cata{X_4}& 1.32X_4 + 0.68X_5 + 2.12X_6
\nonumber \eeqnn 

The seven components are :
glucose $X_1$, 
oxygen $X_2$,
ammoniac $X_3$,
yeasts $X_4$, 
carbon dioxide $X_5$, 
water $X_6$,
ethanol $X_7$.  \qed
\end{exemple}

\section{Reaction systems state model}

The presence of each component inside the system can be quantified.
The component $X_i$ concentration denoted $x_i(t)$ corresponds to its amount in the system divided by the mixture volume.
The concentrations vector, which is also the model state vector, is denoted:
$$ x(t) \teq (x_1(t), x_2(t), \cdots , x_n(t))^T. $$

The reaction rates, also called {\em reaction kinetics}, describes the speed at which reactants are consumed and products are produced per volume unit in the system,
according to the reaction network.
A reaction rate $r_j$ is associated to each reaction of the network $(j = 1, \cdots , m)$.

The reaction rates depend on each component concentrations $x_i$, 
but they can eventually also be influenced by other system physico-chemical factors, such as temperature, catalysts or pressure.

We will here consider reactions depending only on state $x$.
The reaction kinetics vector is denoted:  
$$  r(x) \teq (r_1(x), r_2(x), \cdots , r_m(x))^T.  $$

Each function $r_j : \mathbb{R}_{+}^{n} \rightarrow \mathbb{R}_{+}$ has positive values and is defined on the positive orthant. 
A reaction cannot occurs unless all the reactants are presents in the system. 
In other words, the reaction rate is therefore null if one of the reactants is missing.
Mathematically, this condition can be stated as: 
\begin{hypothese} \label{cond}
\eqn 
&& \mbox{1) } r_j(x) \geq 0 \hspace{3mm} \forall j \hspace{3mm} \forall x \in \mathbb{R}_{+}, \label{cond1}\\ 
&& \mbox{2) }  r_j(x) = 0 \mbox{ si } x_i = 0  \mbox{ for a value of } i, 
\in I^{rj} \label{cond2} 
\eeqn
where $I^{rj}$ stands for the index of the reactants used in reaction $j$ set (including  catalysts).  \qed
\end{hypothese}


Based on the reaction network description and the reaction rates, we can easily check
that the quantitative balance of each component inside the system bounds can be written as:
$$ \dot x_i = \sum_{j = 1}^{m} (\delta_{ij} - \gamma_{ij})r_j(x(t)) + \frac{1}{V}(Q_{0i}(t) - Q_{i0}(t)). \label{contireac} $$

In this equation, the notations $\delta_{ij}$, $\gamma_{ij}$ (stoichiometric coefficients) and $r_j(x(t))$ (reaction rate) were defined earlier.
The notation $V$ stands for the volume (assumed constant) of the domain.
The notations $Q_{0i}(t)$ and $Q_{i0}(t)$ stand for the flows of the component $X_i$ through the domain boundary :
\begin{description}
\item $Q_{io}(t)$ is the flow going from the domain towards the outside,
\item $Q_{oi}(t)$ is the flow going from the outside towards the domain.
\end{description}

This continuity equation states that the variation, per time unit, of the component concentration $X_i$ comes from two distinct mechanisms:
\begin{itemize}
\item $\sum_{j = 1}^{m} (\delta_{ij} - \gamma_{ij})r_j(x(t))$ express the difference, per volume unit, 
between the product quantities sum and consumed quantities sum in the reaction where this component $X_i$ is a product or a reactant respectively;
\item $Q_{0i}(t) - Q_{i0}(t)$ express the difference between the incoming flow and the outgoing flow from the same component $X_i$ towards the domain boundary.
\end{itemize}

The system is said to be {\em closed} when $Q_{io}(t) =  Q_{oi}(t) = 0$ for all $i$ and for all $t$,
in other words, when there is no exchange with the outside.
In the opposite situation, the system is said {\em open}. 

A reaction system state modeling has three fundamental aspects.

First, the reaction network determines the number of state variables, the structure and the numerical values of the stoichiometric matrix coefficients.

Second, we might ask ourselves how to model reaction rates $r_j(x)$ according to the state variables $x_i$.
The modeling will be presented in the following section.

We will then model the incoming and outgoing flows according to the state and the input variables: 
\eqnn
Q_{0i}(x,u) \hspace{1cm} Q_{i0}(x,u)
\eeqnn
This modeling will be illustrated using various examples.

Reaction system dynamic is therefore represented by the following state model:
\eqn 
\dot x =  Cr(x) + q_{in}(x,u) - q_{out}(x,u) \label{sysrea} 
\eeqn
where the definition of vectors $q_{in}(x,u)$ and $q_{out}(x,u)$ is obvious.
This state model can then only be defined on the positive orthant.
We can easily show that, under the \ref{cond} assumption, the system (\ref{sysrea}) is a positive system with a compartments system structure.

For a closed system, vectors $q_{in}$ and $q_{out}$ are identically zeros
and the state model can be reduced to the equation: 
$$ \dot{x} = Cr(x). \label{sysreaferm} $$

\begin{hypothese} \label{princon} {\bf \em The preservation principle}
The stoichiometric matrix kernel contains a positive vector:
$$ \exists \hh \omega = (\omega_1, \ldots , \omega_n)^T \hh
\omega_i > 0 \hh i=1,\ldots,n \hh \mbox{ tel que } \omega \in \ker C^T. \xqedhere{2cm}{\qed} $$
\end{hypothese}

Under this assumption, we easily check that the quantity
$$ z = \sum_{i=1}^m \omega_i x_i = \omega^Tx $$
is a system invariant (\ref{sysreaferm}) (in other words, $z(t)$ is constant along system solutions).

$$ \dot z = \sum_{i=1}^n \omega_i \dot x_i = [\omega^TC]r(x) = 0 $$
and the quantity between brackets is indeed zero thanks to the assumption \ref{princon}.

This assumption is essential because it express the fact that, according to the reality,
a closed reaction system is a preservative system; the total quantity inside the system is a constant:
the produced quantities are equal to the consumed quantities (using appropriate normalization coefficients).
As Lavoisier said, \og rien ne se perd, rien ne se crée \fg.


\section{Reaction kinetics modeling}
If a reaction respects the {\em Law mass action}, a classical general expression, respecting the conditions (\ref{cond1}) - (\ref{cond2}), can be written:
$$ r_j(x) = k_j\prod_{i \in I^{rj}} x_i^{\nu_{ij}} $$
where $k_j$ is the {\em rate constant} of the  $j^{th}$ reaction. 
The mass action principle consists in expressing each reaction rate as being proportional to the product of the reactants concentrations in the reaction
(including catalysts), each concentration being set to the $\nu_{ij}$ positive power called {\em order} of the $j^{reaction}$s.

The mass action Law corresponds to the particular case where $\nu_{ij} = \gamma_{ij} \hh \forall (i,j)$, 
where the reaction orders match the reactants stoichiometric coefficients.

However, the mass action principle is often not enough to match the experimentally observed reaction rates.
We therefore have to generalize the model :
\eqnn r_j(x) =  k_j\prod_{i \in I^{rj}} \rho_{ij}(x_i) \eeqnn
where functions $\rho_{ij} :\mathbb{R}_{+} \rightarrow \mathbb{R}_{+}$ 
respect the following conditions: 
\eqnn && \rho_{ij}(x_i) \geq 0 \hh \hh \forall x_i \geq 0 \\ && \rho_{ij}(0) = 0 \eeqnn

Functions  $\rho_{ij}(x_i)$ are often monotonically increasing function, as shown in figure \ref{Fig:monocrois}. 
\begin{figure}[htbp] 
   \centering
   \includegraphics[height=4cm]{monocrois} 
   \caption{Monotonically increasing kinetic function}
   \label{Fig:monocrois}
\end{figure}
One of the most famous example is called the Michaelis-Menten kinetic and is represented by the function:
$$ \rho_{ij}(x_i) = \frac{x_i}{K_{ij} + x_i}. $$ 


\subsection*{Inhibitors and activators}
A reaction can be slowed down by a reaction product of any other component being in the reaction network.
Such an {\it inhibitor} effect is modeled by adding an additional multiplicative term in the kinetic model.
This term is a decreasing function of the inhibitor component concentration.
The two most frequent models are the following: 
\eqn 
&& \mbox{hyperbolic inhibition : } \rho_{ij}(x_i) = \frac {K_{ij}}{K_{ij} + x_i}, \label{inhibhyper} \\ && \mbox{exponential inhibition : } \rho_{ij}(x_i) = e^{-(K_{ij}x_i)}.
\label{inhibexpo} 
\eeqn

\begin{exemple}  Let consider the following reaction network:
\begin{equation} \begin{split} \label{exa}
X_1 + X_2 \; &\longrightarrow \; 2X_3, \\ 
2X_3 \; &\longrightarrow \; X_4. 
\end{split} \end{equation}
Suppose that kinetics respect the mass action law and that the first reaction is the most inhibited by the $X_4$ product of the second reaction, 
following an exponential law (\ref{inhibexpo}).
Both reaction kinetics will have the following form:
\begin{equation} \begin{split} \label{cin}
r_1(x) &= k_1x_1x_2e^{-(Kx_4)}, \\
r_2(x) &= k_2x_3^2. \xqedhere{6.2cm}{\qed}
\end{split} \end{equation}
\end{exemple}

A component in the reaction can also have a speed effect without being required to the reaction
(this component is nor a reactant nor a catalyst of the reaction).
Such {\it activator} effect is modeled by adding an additional multiplicative term in the kinetic model.
This term is an increasing function of the activator component concentration (which is non zero at start).

\section{Perfectly Stirred Tank Reactors}

Perfectly stirred chemical or biological reactors are one of the most typical examples of reaction systems. These reactors are made of a tank containing a liquid reaction medium mixed permanently by a suitable agitation system. The composition of the tank is considered homogeneous. The various reagents can be provided to reactor in liquid or gaseous form. Reaction products are created in solution in the reaction medium. Some of these products can be  easily gasifiable and can freely escape from the reactor in gaseous form.
The reaction medium is \blue{withdrawn} to collect products.

\subsection {Continuous Reactors}

A perfectly stirred tank reactor work in {\em continuous-flow mode} when feed and withdrawal rate are adapted so that the volume $V$ of the reaction medium is constant.
This is called {\em continuous stirred tank reactor} (acronym CSTR).
An example of this kind of reactor is illustrated in the figure \ref{Fig:CSTR}. 
\begin{figure}[htbp] 
   \centering
   \includegraphics[height=6cm]{CSTR} 
   \caption{Perferctly stirred tank reactor}
   \label{Fig:CSTR}
\end{figure}
The tank is fitted with a supply pipe and a suitable overflow to keep constant volume.

It is assumed this reactor is the place of a set of $m$ reactions involving $n$ chemical species $X_1, X_2, \dots , X_n$.
The species concentrations in the reaction medium are noted $x_i$.
The various species are supplied to reactor in solution or in suspension in the feed flow with concentrations noted $x_i^{in}$.
The feed volumetric flow is noted $F_{in}$. With these notations and definitions, balance equation of the species in the reactor can be noted in the following matrix form:
$$
\dot xV = Cr(x)V - F_{in}x + F_{in}x^{in}
$$
where $C$ is the stoichiometric matrix of the reaction network, $r(x)$ the vector of reactions rates, $x$ the vector of concentrations $x_i$ and $x^{in}$ the vector of feed concentrations $x_i^{in}$.

By defining the input variable
$$ 
u \triangleq \frac{F_{in}}{V}
$$
which is the feed rate per unit of volume, also called {\em \blue{dilution ratio}} (the inverse of dilution ratio is the \blue{retention time}), we get the state model of a perfectly stirred tank reactor:
$$
\dot x = Cr(x) - ux + ux^{in}. \label{CSTR}
$$
It is observed this model has the structure (\ref{sysrea}) with the following definitions:
$$
q_{out}(x,u) = ux \hh \hh \hh q_{in}(x,u) = ux^{in}.
$$

\begin{exemple}{\blanc} \label{exempleCSTR}

We consider a perfectly stirred tank reactor in which the two reactions (\ref{exa}) run simultaneously
in the liquid phase with kinetics (\ref{cin}). 
The reactor is fed by the two initial reagents $X_1$ and $X_2$ in solution with feed concentrations $x_1^{in}$ and $x_2^{in}$.

The state model is written
$$
\bma{c} \dot x_1 \\ \dot x_2 \\ \dot x_3 \\ \dot x_4 \ema =
\bma{cc} -1 & 0 \\ -1 & 0 \\ 2 & -2 \\ 0 & 1 \ema \bma{c}
k_1x_1x_2e^{-(Kx_4)} \\ k_2x_3^2 \ema 
 + u \bma{c} x_1^{in} -x_1 \\ x_2^{in} -x_2 \\ -x_3 \\ -x_4
\ema   
$$
where state variables $x_1, x_2, x_3$ and $x_4$ represent the concentrations of the species in the reaction medium. \qed
\end{exemple}

\subsection{Reactor with Variable Volume }

Now, let's consider the reactor illustrated in the figure \ref{Fig:CSTR2}.
It's the same as the previous one but the overflow is replaced by a withdrawal pipe, the volumetric flow $F_{out}$ of which is regulated with a pump. In the particular case where the flow rate $F_{out}$ may be intermittently zero (no withdraw), we say the reactor works in \blue{batch mode (discontinuous mode)}.

\begin{figure}[htbp] 
   \centering
   \includegraphics[height=6cm]{CSTR2} 
   \caption{Variable volume reactor}
   \label{Fig:CSTR2}
\end{figure}

The matrix equation of species mass balance is written as follows:
$$
\frac{d}{dt} (xV) = Cr(x)V - F_{out}x + F_{in}x^{in}.
$$
The reaction medium volume can vary if feed and withdrawal rate are different. The volume variations are described by the volumetric balance equation:
$$
\dot V = F_{in} -F_{out}.
$$
If both volumetric rates $F_{in}$ and $F_{out}$ are chosen as input variables $u_1$ and $u_2$, we get the following state model:
\begin{equation*} \begin{split}
\dot x &= Cr(x) + \frac{u_1}{x_{n+1}} (x^{in} - x), \\
\dot x_{n+1} &= u_1 - u_2,
\end{split} \end{equation*}
with the additional state variable $x_{n+1}$ referring the volume $V$.

It is interesting to choose flow rates by unit of volume $u_1 = F_{in}/V$ and $u_2 = F_{out}/V$ as input variables.
In this case, the state model is written

\begin{equation*} 
\begin{split}
\dot x = Cr(x) + u_1(x^{in} - x), \\
\dot x_{n+1}= (u_1 - u_2)x_{n+1}.
\end{split} 
\end{equation*}

The first of this two equations describe the changes of the reactor composition. 
This is independent of $u_2$ and $x_{n+1}$ and is identical to that we get for a reactor with a constant volume  (\ref{CSTR}). 

\subsection{Non Isothermal Reactors}

The rate of a chemical reaction also depends on the temperature of the reaction medium.
Up to now we have not taken this dependence into account in modeling: it was implicitly assumed the temperature is regulated so we maintain a perfectly constant temperature.
Absent such regulation, it is the rate constant which depends on the temperature. The general form of the speed of the $j$-th reaction is written
$$
r_j(x,T) = k_j(T)\rho_j(x)
$$
where $T$ stands for the temperature (in Kelvin) of the reaction medium and the function $\rho_j(x)$ satisfies the hypothesis conditions (\ref{cond1})-(\ref{cond2}). The function $k_j(T)$ is positive, bounded and $k_j(0) = 0$. A typical example is given by the {\it Arrhenius law} illustrated in the figure \ref{Fig:arrhenius}:
\eqnn
k_j(T) = k_{0j}exp(-\frac{E_j}{RT})
\eeqnn

\begin{figure}[htbp] 
   \centering
   \includegraphics[width=8cm]{arrhenius} 
   \caption{Arrhenius law}
   \label{Fig:arrhenius}
\end{figure}

where $k_{0j}$ is a constant, $E_j$ the activation energy of the reaction and $R$ the Boltzmann constant.
This function of the temperature is a monotonously increasing and bounded.
In some applications (particularly in biotechnology) the function $k_j$ can also be monotonic.

The state model of a non isothermal reactor is achieved by adding an energy balance equation to mass and volume balance equations. 
For example, let's consider a continuous reactor equipped with a heat exchanger. 
The energy balance equation is written as follows:

$$
\delta c_p V\dot T = (\sum_{j=1}^{m}\Delta H_j r_j(x,T))V +
\delta c_p F_{in} (T_{in} - T) + Q
$$
where $\delta$ is the reaction medium density, $c_p$ the heat capacity, $\Delta H_j$ the reaction heat, $T_{in}$  the feed flow temperature and $Q$ the heat flow exchanged.
If it is assumed the parameters $\delta$, $c_p$ and $\Delta H_j$ are constant, we get the heat balance equation: 
$$ 
\dot T = \sum_{j=1}^{m} h_j r_j(x,T) +
d(T_{in} - T) + q
$$
where $h_j = \Delta H_j/c_p\delta V$ is the specific heat of reaction, $d = F_{in}/V$ is the dilution ratio and $q = Q/c_p \delta V$.

The parameters $h_j$ can be positive or negative. 
If $h_j$ is negative, the reaction is endothermic: it consumes heat provided by heat exchanger.
If $h_j$ is positive, the reaction is exothermic: heat is generated and reactor has to be cooled by the heat exchanger.

The specific heat flow exchanged $q$ is a function of the temperature $T$.
A simple model is the statement $q$ is proportional to the difference between reactor and input temperature, respectively $T$ and $T_w$:
$$ q = e(T_w - T) $$
In this case, the global state model of the reactor is written:
\begin{equation*} \begin{split}
\dot x &= Cr(x) + d(x^{in} - x), \\
\dot x_{n+1} &= h^T r(x) + d(T_{in} - x_{n+1}) + e(T_w - x_{n+1}).
\end{split} \end{equation*}
with the additive state variable $x_{n+1}$ referring temperature $T$.
As input variables, we can choose, for example, the dilution ratio $d$ and the heat transfer coefficient $e$ which is proportional to the flow of the heat exchanger.

\section{Ecological Systems} 

The reaction formalism and the state model (\ref{sysrea}) are also suitable to describe an important class of ecological systems (or ecosystem) in which populations of living organisms (vegetable or animal) share a same habitat.

The mathematical model of an ecosystem is presented as a particular case of reaction system in which:

\begin{itemize}
\item the reaction network describes interactions between species:
 inert resource consumption, grazing on vegetable resource, predation, etc.
 Reactions are necessarily  auto-catalytic.
\item inflows represent the supply of resources to the system by external agent and immigration of some species.
\item outflows represent emigration of species outwards, the capture by external agents (hunting, fishing, harvesting, gathering, \dots) or simply natural mortality in species. 
\end{itemize}

We begin with one simple example.

\begin{exemple}{\bf \em  Algae in the lagoon}

An organic nutrient coming for example from domestic waste water or agricultural fertilizer is released to the lagoon. 
A population of floating single-celled algae (phytoplankton) grows on the surface water feeding on this nutrient. 
This situation can be described  by the reaction:
\eqn
kY \longrightarrow X. \label{reacrois}
\eeqn
expressing that in the growing mechanism of algae, the nutrient $Y$ is transformed in living matter (or biomass) $X$ with a yield $k^{-1}$.
Algae may also die as all living beings.

As consequence, the lagoon can be considered as a wide reactor transforming reagent $Y$ (the nutrient) in product $X$ (the biomass). The reactor is fed by a reagent inflow (the nutrient released to the lagoon) while mortality causes a product outflow. Under the spatial homogeneity assumption, dynamic of this reactor is described by the state model

\begin{equation} \begin{split} \label{lagune}
\dot y &= -kr(x,y) + v, \\
\dot x &= r(x,y) - dx.
\end{split} \end{equation}

where $y$ represent the nutrient concentration, $x$ the density of the algae population, $v$ the nutrient feed rate (per unit of volume) of the lagoon, $dx$ the assumed mortality proportional to the population density (coefficient $d$ is the specific mortality rate) and $r(x,y)$ the reaction speed, namely the growing speed of algae. \qed
\end{exemple}

From a broader standpoint, reaction (\ref{reacrois}) can represent the growing of any population of living organisms (vegetable or animal) $X$ that in a determined habitat, consumes a food resource $Y$.
This food resource can be inert matter (organic or inorganic) as in the above example.
It could also be another living species (vegetable or animal): this is called {\em prey - predator}  model in which resource species $Y$ is the prey and the consumer one is $X$ the predator.
Obviously, this growing reaction is auto-catalytic because $X$ represent necessarily a population of self-reproductive living beings:
\eqnn
kY \cata{X} X.
\eeqnn

It is therefore natural for there to consider that the growth speed is proportional to the predator population density and to represent the function $r(x,y)$ with this kind of model:
\eqnn
r(x,y) \teq \mu(x,y)x
\eeqnn
where the function $\mu(x,y)$ is called the {\em specific growth rate}.
This function has to be defined so that the reaction rate verifies conditions (\ref{cond1}) - (\ref{cond2}), namely:
\begin{itemize}
\item $\mu(x,y)$ is a positive definite function on the positive orthant:
\eqnn
\mu(x,y) \geq 0 \hh \hh \forall (x,y) \in \mathbb{R}_{+}^{2}.
\eeqnn
\item $\mu(x,0) = 0$ : no food supply means no growth.
\end{itemize}
The specific growth rate can depend on many environmental factors.
Two typical non linear effects are {\em satiety} and {\em overpopulation} effects.
\begin{description}
\item[Satiety effect: ] When food supply is scare, it is usually observed that the specific growth rate is an increasing function of available amount of supply.
However it exists a physiological limit on the resource consumption rate and so on the growth rate.
This can be modeled with $\mu(x,y)$ as an increasing saturated function of $y$, so that the growth speed is independent of $y$ beyond a critical concentration $y_c$:
\eqnn
\frac{\partial \mu(x,y)}{\partial y} \geq 0, \hspace{1cm}
\mu(x,y) = \mu(x,y_{c}) \hh \hh \forall \hh y \geq y_{c}.
\eeqnn
\item[Overpopulation effect:] Even when there is a food over-supply, the population density is usually limited by the available space. This can be modeled with $\mu(x,y)$ as a decreasing function of density $x$ which becomes zero when the population reaches its maximal value $x_m$:
 \eqnn
\frac{\partial \mu(x,y)}{\partial x} \leq 0, \hspace{1cm}
\mu(x,y) = 0 \hh \hh \forall \hh x \geq x_{m}.
\eeqnn
\end{description}

\begin{exemple}{\bf The Contois model.}
This is classic model of specific rate  used to describe the growth of micro-organisms populations:
\eqnn
\mu(x,y) = \frac{\mu_0 y}{y + Kx}.
\eeqnn
It is observed this model is an increasing bounded function of $y$ (identical to the Michaelis-Menten model for $x$ fixed) and a decreasing (hyperbolic) function of $x$.
\blue{However satiety and overpopulation concentration limits ($y_c$ and $x_m$ respectively) are rejected to infinity.}  \qed
\end{exemple}

\begin{exemple}{\bf The logistic model}

It's common to adopt the following multiplicative structure for the specific growth rate:
\eqnn
\mu(x,y) = \sigma(y)\phi(x).
\eeqnn
This structure allows to model separately satiety and overpopulation effects, for example in the following way:
\begin{equation*} \begin{split} \sigma(y) &= \left\{\begin{array}{ll}
\alpha y & \forall y \leq y_{c} \\ \alpha y_{c} & \forall y \geq y_{c} \end{array} \right.\\ \\
\phi(x) &= 
\left\{ \begin{array}{ll} (1 - \frac{x}{x_{m}}) & \forall x \leq x_{m} \\ 0  & \forall x \geq x_{m}
\end{array} \right.
\end{split} \end{equation*}
It is noticeable that the functions $\sigma$ and $\phi$ are linear and saturated (see figure \ref{Fig:logistic}).
\begin{figure}[htbp] 
   \centering
   \includegraphics[height=5cm]{logistic} 
   \caption{Specific growth rate for th logistic model}
   \label{Fig:logistic}
\end{figure}
With these definitions, when $y \leq y_{c}$ and $x \leq x_{m}$, the prey - predator model (\ref{lagune}) can be written as
\begin{equation*} \begin{split}
\dot y &= -k\alpha xy(1 - \frac{x}{x_{m}}) + v, \\
\dot x &= \alpha xy(1 - \frac{x}{x_{m}}) - dx.
\end{split} \end{equation*}
On the other hand, when the food supply is provided to the system  in sufficiently large quantities to maintain concentration above its critical value ($y(t) \geq y_{c} \hh \forall t$), then the dynamic of the predator population becomes {\em independent of the available amount of food supply} and can be written as:
\eqn
\dot x = \sigma_{c}x(1 - \frac{x}{x_{m}}) - dx  \label{logis}
\eeqn
where $\sigma_c = \alpha y_c$. The function $\phi(x) = (1 - x/x_{m})$ is usually called {\em logistic model} in the literature.
By extension, the model (\ref{logis}) is called logistic model of a population growth on a non-limiting food supply. \qed
\end{exemple}

Up to now we have considered a simple model which only involves two species $X$ and $Y$.
This description can be extended without difficulty to more complex ecosystems in which several biological species (vegetable or animal) can coexist and interact within the same habitat. Here is an example.

\begin{exemple} {\bf A aquatic ecosystem}

An aquatic ecosystem, as all other natural ecological system, is usually characterized by the cohabitation  of three kinds of biological species: vegetable,  herbivorous animal and carnivorous animal species.
\begin{figure}[htbp] 
   \centering
   \includegraphics[height=5cm]{aquatic} 
   \caption{Aquatic ecosystem}
   \label{Fig:aquatic}
\end{figure}
For example, let's us consider a pond (see figure \ref{Fig:aquatic}) in which is released an organic nutrient $X_1$.
A population of algae (phytoplankton) $X_2$ grows by consumption of this nutrient.
A population of tiny herbivorous crustaceans $X_3$ grazes on the phytoplankton which is its principal food supply.
A population of carnivorous fish $X_4$ ensure its development and its growth by consumption of the crustaceans.
The animal breathing consumes oxygen $X_5$ in the water produced by the photosynthesis .
This description is represented by the following reaction network:
\eqnn
c_1X_1 &\cata{X_2}& X_2 + c_4X_5, \\
c_2X_2 + c_5X_5 &\cata{X_3}& X_3, \\
c_3X_3 + c_6X_5 &\cata{X_4}& X_4. 
\eeqnn
A state model of this system is realized under the following hypothesis and with these notations:
\begin{itemize}
\item The organic nutrient is released with a flow rate per unit of volume $v$.
\item The three biological species are subject to natural mortality.
The mortality coefficients are labeled $d_i, i = 2,3,4$.
The coefficient of proportionality is noted $d_1$.
\item The growth kinetic of algae is described by the logistic model, with a Michaelis Menten dependency to nutrient concentration
\item Both kinetics of animal populations are described by the Contois model with a Michaelis Menten dependency to the oxygen concentration in the water.
\end{itemize} 
The state model of this aquatic ecosystem is written as:
\begin{equation*} \begin{split}
\bma{c}  \dot x_1 \\ \dot x_2 \\
\dot x_3 \\ \dot x_4 \\ \dot x_5 \ema &= \bma{ccc} -c_1 & 0 & 0\\ 1 & -c_2
& 0 \\ 0 & 1 & -c_3 \\ 0 & 0 & 1 \\ c_4 & -c_5 & -c_6 \ema \bma{c}
\frac{{\textstyle \mu_1 x_1 x_2}}{{\textstyle x_1 + K_1}}(1 -
\frac{{\textstyle x_2}}{{\textstyle x_{2c}}}) \\ 
\\
\frac{{\textstyle \mu_2 x_2 x_3}}{{\textstyle x_2 + K_2x_3}}  \frac{{\textstyle
x_5}}{{\textstyle x_5 +K_4}} \\
\\
\frac{{\textstyle \mu_3 x_3 x_4}}{{\textstyle x_3 + K_3x_4}} \frac{{\textstyle
x_5}}{{\textstyle x_5 +K_5}}
\ema 
\\ & \\&- \bma{ccccc} 0 & 0 & 0 &
0 & 0 \\ 0 & d_2 & 0 & 0 & 0 \\0 & 0 & d_3 & 0 & 0  \\0 & 0 & 0 & d_1 + d_4 & 0
\\0 & 0 & 0 & 0 & 0
\ema \bma{c} x_1 \\  x_2 \\  x_3 \\  x_4 \\ x_5 \ema + \bma{c} v \\ 0  \\ 0 \\
0 \\ 0 \ema.    
\end{split} \end{equation*}
The state variables $x_2,x_3,x_4$ denote the density of the three biological populations 
while $x_1$ et $x_5$ denote respectively the nutrient and oxygen concentrations. \qed
\end{exemple}
 
\section{Exercices}

\begin{exercice}{\bf \em Un procédé chimique}

Une installation de génie chimique est représentée à la figure
\ref{Fig:genchim}. Une réaction réversible $A+B \leftrightarrow C$, obéissant
à la loi d'action des masses, se déroule dans le réacteur.
\begin{figure}[htbp] 
   \centering
   \includegraphics[height=6cm]{genchim} 
   \caption{Un procédé chimique}
   \label{Fig:genchim}
\end{figure}
 Le séparateur est
supposé opérer une séparation parfaite et instantanée des trois
espèces chimiques. Le réactif $B$ est recyclé via une cuve de
stockage. Le réactif $A$ et le produit $C$ sont soutirés du système.
Proposer un modèle d'état du système. \qed
\end{exercice}
\vv

\begin{exercice}{\bf \em Réacteur avec alimentations séparées}

Nous avons considéré dans ce chapitre que les différentes espèces qui alimentent un
réacteur sont fournies ensemble par une canalisation unique (voir par exemple la
figure \ref{Fig:CSTR}). Un tel dispositif peut avoir l'inconvénient de voir les
réactions débuter dans la canalisation d'amenée avant d'atteindre le réacteur. Cet
inconvénient est évité si les réactifs sont introduits dans le réacteur par des
canalisations séparées. Reconsidérons l'exemple \ref{exempleCSTR} avec des alimentations séparées pour
les deux réactifs $X_1$ et $X_2$ (voir figure \ref{Fig:CSTRsepar})~:
\begin{figure}[htbp] 
  \centering
   \includegraphics[height=6cm]{CSTRsepar} 
   \caption{Réacteur continu avec alimentations séparées}
   \label{Fig:CSTRsepar}
\end{figure}
\begin{enumerate}
\item Etablir un modèle d'état du système si les variables d'entrée sont les deux débits volumique d'alimentation $F_{01}$ et $F_{02}$.
\item Un cas particulier intéressant est celui ou le réacteur
est alimenté à débit volumique total constant ($F_{01} + F_{02} =$ constante).
Seule la composition de l'alimentation est variable. En pratique cela peut être
réalisé en ajustant complémentairement les deux débits $F_{01}$ et $F_{02}$
avec une vanne à quatre voies (voir figure \ref{Fig:vanne4voies}) de manière
que leur somme soit constante.  
\begin{figure}[htbp] 
   \centering
   \includegraphics[height=4cm]{vanne4voies} 
   \caption{Alimentations séparées avec vanne à quatre voies}
   \label{Fig:vanne4voies}
\end{figure}
On choisit le débit $F_{01}$
comme unique variable d'entrée et on définit le taux de dilution constant $d =
(F_{01} + F_{02})/V$. Etablir le modèle d'état du système et montrer qu'il s'écrit sous la forme (\ref{sysrea}). \qed
\end{enumerate}
\end{exercice}
\vv

\newpage
\begin{exercice}{\bf \em Réactifs et produits gazeux}

Le modèle d'état (\ref{CSTR}) d'un réacteur continu parfaitement mélangé
peut être étendu au cas de réactifs ou de produits gazeux. Supposons tout
d'abord que le réacteur soit alimenté par un réactif $X$ sous forme gazeuse
(par exemple de l'oxygène) avec un débit massique $Q_{in}$ (voir figure
\ref{Fig:CSTRgaz}).
\begin{figure}[htbp] 
   \centering
   \includegraphics[height=6cm]{CSTRgaz} 
   \caption{Réacteur avec réactifs et produits gazeux}
   \label{Fig:CSTRgaz}
\end{figure}
Le réactif barbote dans le milieu liquide où il est partiellement dissous. L'excès de
réactif non-dissous s'échappe librement du réacteur sous forme gazeuse avec un
débit massique $Q_{out}$. La quantité de réactif mise en solution par unité
de temps est donc $Q_{in} - Q_{out}$. En se basant sur la loi de Henry et en
négligeant la dynamique du transfert gaz-liquide, on peut modéliser cette
quantité comme étant proportionnelle au débit gazeux d'alimentation d'une part
et au déficit de saturation d'autre part~:
\eqnn
Q_{in} - Q_{out} = aQ_{in}(x^{sat} - x)
\eeqnn
où $x$ désigne la concentration de l'espèce $X$ en solution et $x^{sat}$ la
concentration de saturation de cette même espèce dans la phase liquide.

Considérons maintenant qu'un produit de réaction $X$ (par exemple du $CO_2$)
formé en solution est gazéifiable. Il s'échappe du milieu réactionnel avec un débit
massique $Q_{out}$. Sous une hypothèse d'équilibre entre les phases liquide et
gazeuse, on peut considérer que ce débit est proportionnel à la concentration du
produit $X$	en solution dans le milieu réactionnel~:
\eqnn
Q_{out} = dx
\eeqnn
\begin{enumerate}
\item Comme dans l'exemple \ref{exempleCSTR}, considérons un réacteur
continu  dans lequel
 les deux réactions (\ref{exa})-(\ref{exb})
se déroulent simultanément dans la phase liquide avec les cinétiques
(\ref{cin}).  Cette fois, nous supposons cependant que le
réactif $X_2$ et le produit $X_4$ sont sous forme gazeuse. 
On demande d'établir le modèle d'état du système sous les hypothèses de modélisation suivantes~: 
\begin{itemize} 
\item Le réacteur est alimenté par le réactif initial $X_1$ en
solution avec un débit volumétrique $F_{in}$ et une
concentration d'alimentation $x_1^{in}$. 
\item Le réactif $X_2$ est injecté dans le réacteur sous forme gazeuse.
  La quantité de réactif $X_2$ mise en
solution par unité de temps est notée $aQ_{in}(x_2^{sat} - x_2)$.
\item Les produits $X_3$ et $X_4$ sont
formés en solution dans le milieu réactionnel. Le produit $X_4$ est
gazéifiable et s'échappe du réacteur avec un débit gazeux $dx_4$.
\end{itemize}
\item Si les variables d'entrée sont le débit volumétrique d'alimentation liquide par unité de
volume de milieu réactionnel $u_1 = F_{in}/V$ et le débit massique d'alimentation
gazeuse par unité de volume de milieu réactionnel $u_2 = Q_{in}/V$, montrer
que le modèle d'état possède la structure (\ref{sysrea}). \qed
\end{enumerate}
\end{exercice}
\vv

\begin{exercice}{\bf \em Une réacteur biochimique}

Un réacteur biochimique fonctionnant en mode CSTR met en jeu trois
espèces : une population bactérienne $X_1$, du glucose $X_2$,
et du lactose $X_3$.\\

La dynamique du réacteur est décrite par le modèle d'état suivant
($x_i$ désigne la concentration de l'espèce $X_i$): 
\begin{equation*} \begin{split}
\dot x_1 &= x_1x_2-ux_1,\\
\dot x_2 &= -x_1x_2 +x_1x_3 -ux_2,\\
\dot x_3 &= -x_1x_3 +u(c-x_3) \;\;\;\; c>0. 
\end{split} \end{equation*}

\begin{enumerate}
\item Quel est le schéma réactionnel ?
\item L'entrée $u$ est positive :  $u>0$.  Que représente-t-elle physiquement ?
\item Montrer que le système est positif. \qed
\end{enumerate}
\end{exercice}
\vv

\begin{exercice}{\bf \em Des coccinelles et des pucerons}

Montrer que le système (\ref{coc}) du chapitre 1 modélisant l'interaction entre les populations de coccinelles et de pucerons est un système réactionnel. \qed
\end{exercice}
\vv

\begin{exercice}{\bf \em Une station d'épuration biologique aérobie}

Une station d'épuration biologique aérobie est schématisée à la
figure \ref{Fig:epurat}.
\begin{figure}[htbp] 
   \centering
   \includegraphics[width=11cm]{epurat} 
   \caption{Station d'épuration biologique aérobie}
   \label{Fig:epurat}
\end{figure}
Le bassin d'aération est alimenté par des eaux  usées
(débit
$F_{in}$) contenant un substrat organique polluant  (concentration $S$). 
Ce substrat organique est dégradé par des microorganismes
(concentration $X$) aérobies.  Cette dégradation nécessite de
l'oxygène dissous dans l'eau (concentration $O$) et produit du dioxyde
de carbone (concentration
$C$) sous forme dissoute mais qui se gazéifie aisément et sort du
système sous forme gazeuse.  L'oxygène dissout est fourni par un
système d'aération (débit d'air $Q_{in}$).  On fait l'hypothèse que
les dynamiques de transfert entre phase gazeuse et phase liquide sont
négligeables (instantanées).

La sortie du bassin d'aération est connectée à un bac de
sédimentation (décantation) où la biomasse (c'est à dire la masse 
des microorganismes) est séparée du reste.  L'eau clarifiée est
évacuée du système (débit $F_{out}$).  La biomasse est recyclée
vers le bassin d'aération (débit $F_R$).  Cependant, on prévoit la
possibilité d'éliminer la biomasse en excès (débit $F_S$).  Les
niveaux dans le bassin d'aération et dans le décanteur sont
supposés constants.  Le bassin d'aération est supposé parfaitement
mélangé.  Le bassin de décantation (qui ne peut être
parfaitement mélangé !) est modélisé par deux réservoirs
(compartiments) parfaitement mélangés (un pour l'eau clarifiée, un
pour la biomasse décantée).  On suppose aussi qu'il n'y a aucune
réaction biologique dans le décanteur. On demande d'établir un modèle d'état du système. \qed
\end{exercice}
\vv

\begin{exercice}{\bf \em Un système non conservatif}

Soit le réseau réactionnel suivant~:
\begin{equation*} \begin{split} 
X_1   &\longrightarrow X_2 + X_3 \\
X_3 &\longrightarrow 2X_1 + X_4
\end{split} \end{equation*}
\begin{enumerate}
\item Etablir le modèle d'état d'un système réactionnel fermé
sous les hypothèses de modélisation suivantes : principe d'action des
masses pour la première réaction avec une vitesse d'ordre 2
par rapport à tous les réactifs, cinétique de Michaelis-Menten pour
la deuxième réaction avec inhibition hyperbolique par $X_2$.
\item Montrer que le système n'est pas conservatif. Donner une
justification physique.
\item Montrer qu'il suffit d'ajouter un réactif initial dans la première 
ou la deuxième réaction pour rendre le système conservatif. \qed
\end{enumerate}
\end{exercice}

\end{document}
  

